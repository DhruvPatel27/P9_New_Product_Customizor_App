<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href="static/CSS/cart-design.css" rel="stylesheet" type="text/css">
    <!--The following script tag downloads a font from the Adobe Edge Web Fonts server for use within the web page. We recommend that you do not modify it.-->
    <script>var __adobewebfontsappname__="dreamweaver"</script>
    <script src="http://use.edgefonts.net/montserrat:n4:default;source-sans-pro:n2:default.js"
            type="text/javascript"></script>
    <script type="text/javascript">
	 function openPage(pageURL)
		 {
		 window.location.href = pageURL;
		 }
    </script>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
	<script>
    $(function(){
      $("#basic-layout").load("basic-layout.html");
    });
    </script>
    <script>
    var num = 0;
    function grabImage(id){
        if (typeof(Storage) !== "undefined") {
            var image = localStorage.getItem(id);
            document.getElementById("final_image").id = num;
            document.getElementById(num).src = image;
            num = num + 1;
        }
    }
    </script>
    <script>
        var numPrice = 0;
        function calculateTotal(price, quantity){
            var total = price * quantity;
            document.getElementById("product-line-price").id = "price"+numPrice;
            document.getElementById("price"+numPrice).value = total;
            document.getElementById("price"+numPrice).innerHTML = "$"+(total).toFixed(2);
        }
        var subTotal = 0;
        function calculateSubTotal(){
            subTotal = subTotal + document.getElementById("price"+numPrice).value;
            numPrice = numPrice + 1;
        }
        function displaySubTotal(){
            document.getElementById("cart-subtotal").innerHTML = "$"+subTotal.toFixed(2);
            document.getElementById("cart-total").innerHTML = "$"+(5.00 + subTotal).toFixed(2);
        }
    </script>
</head>
<body>

<div id="basic-layout"></div>
{% if product_len > 0%}
<div class="column_total">Total</div>
<div class="column_remove">Remove</div>
<div class="column_quantity">Quantity</div>
<div class="column_price">Price</div>
{% endif %}
<h1>Shopping Cart</h1>


<div id="line"></div>
{% if product_len > 0%}
{%for i in range(0, product_len)%}
<div class="shopping-cart">
    <div class="product">
        <div class="product-image">
            <img id="final_image" class="placeholder" src="data:image/png;base64,{{product[i]['image'].decode('utf-8')}}" height="100" width="100">
        </div>
        <script>grabImage({{product[i]['Product_id']}});</script>
        <div class="product-details">
            <div class="product-title"><b>{{product[i]['title']}}</b></div>
            <p class="product-description">{{product[i]['description']}}</p>
        </div>
        <div class="product-price">${{product[i]['price']}}</div>
        <div class="product-quantity">{{product[i]['quantity']}}</div>
        <div class="delete"><button class="deleteButton">-</button></div>
        <k id="product-line-price"></k>
        <script>calculateTotal({{product[i]['price']}}, {{product[i]['quantity']}})</script>
        <script>calculateSubTotal()</script>
  </div>
</div>
{%endfor%}

<div class="totals">
    <div class="totals-item">
        <label>Subtotal</label>
        <div class="totals-value" id="cart-subtotal"></div>
    </div>
    <div class="totals-item">
        <label>Shipping</label>
        <div class="totals-value" id="cart-shipping">$5.00</div>
    </div>
    <div class="totals-item totals-item-total">
        <label>Grand Total</label>
        <div class="totals-value" id="cart-total"></div>
    </div>
    <script>displaySubTotal()</script>
</div>
{% if not session['user_name'] %}
<div class="email-input"><div class="email">Email ID:</div><input class="text" name="username" type="text"></div>
{% endif %}
<h3><button class="buttons" id="checkout">Checkout</button></h3>
{%else%}
<h2 id="empty">Cart Empty</h2>
{% endif %}

</body>
</html>